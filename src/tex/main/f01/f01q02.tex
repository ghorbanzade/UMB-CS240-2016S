%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% CS240: Programming in C
% Copyright 2015 Pejman Ghorbanzade <mail@ghorbanzade.com>
% Creative Commons Attribution-ShareAlike 4.0 International License
% https://github.com/ghorbanzade/UMB-CS240-2016S/blob/master/LICENSE
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section*{Question 2}

Bilbo Baggins, a former CS240 student who is now an expert in programming in C, has developed a program that prompts user for a string and prints the reversed version of the string to standard output.

A sample run of the program is given below, where user input is shown in italic.

\begin{terminal}
$ gcc reverse.c -o reverse
$ ./reverse
string: @*\textit{cs240 final exam}*@
reverse: maxe lanif 042sc
\end{terminal}

Both \texttt{reverse.c} and \texttt{reverse.h} source codes are provided below.

\lstset{language=c,tabsize=4}
\lstinputlisting[firstline=10]{\resDirectory/reverse.h}
\lstinputlisting[firstline=10]{\resDirectory/reverse.c}

The program compiles and executes as expected.
Based on the given source code, provide \textbf{brief} answers for the following questions.

\begin{enumerate}
\item
In \texttt{reverse.c:1}, Bilbo has used the include directive to include \texttt{reverse.h} during program compilation.
This could have been avoided, simply, by prepending content of \texttt{reverse.h} to \texttt{reverse.c} file.
Explain some of the advantages of using a header file as in \texttt{reverse} program.

\item
In \texttt{reverse.h:1,2,10}, preprocessing directives have been used that conditionally define \texttt{REVERSE\_H} as a macro with no value.
It appears the program still compiles and executes as before, if these lines are removed.
Explain why Bilbo has included these lines in the header file.

\item
In \texttt{reverse.h:8}, the \texttt{reverse} function is declared but not defined.
Explain why removing this line causes a compilation error and how the error can be resolved without including this line.

\item
Line \texttt{reverse.c:11}, deallocates the heap memory assigned to \texttt{rev} pointer.
However, there is no explicit \texttt{malloc} call inside the \texttt{main} function to allocate heap memory for \texttt{rev}.
Explain why \texttt{rev} is freed in line 11 and what happens if this line is removed.

\item
Line \texttt{reverse.c:19}, introduces a \textit{while} loop with a given condition.
Surprisingly, the body of the \textit{while} has no statements and the line terminates with a semicolon.
Explain what is the function of the while loop and why it does not include any statement.

\item
Line \texttt{reverse.c:20} allocates as many bytes as the value of variable \texttt{i} on the heap memory and assignes its address to variable \texttt{ret}.
It has been sugggested that this line should be replaced by \texttt{ret = malloc(i * sizeof(char))} as the requested memory block should hold \texttt{i} characters.
Describe whether line \texttt{reverse.c:20} should be changed according to proposed suggestion.

\item
Line \texttt{reverse.c:21}, is a call to assert function whose purpose is to abort the program if its given expression evaluates to false.
Explain why Bilbo is checking the value of \texttt{ret} variable after a call to \texttt{malloc} function in \texttt{reverse.c:20}.

\item
Explain the objective of line \texttt{reverse.c:24} and what will happen if this line is removed.
\end{enumerate}
